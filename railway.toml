[[services]]
id = "backend"
source = "./backend"

[services.backend]
buildCommand = "docker build -t backend ."
startCommand = "docker run -p $PORT:5000 -e PORT=5000 -v railway_uploads:/app/uploads backend"
healthcheckPath = "/api/health"
restartPolicyType = "ON_FAILURE"

[services.backend.environment]
PORT = "5000"
JWT_SECRET = "your_jwt_secret_here_change_in_production"
# DATABASE_URL will be automatically set when attaching PostgreSQL

[[volumes]]
id = "railway_uploads"

[[services]]
id = "frontend"
source = "./frontend"

[services.frontend]
buildCommand = "npm install && npm run build"
startCommand = "npm start"
healthcheckPath = "/"
restartPolicyType = "ON_FAILURE"

[services.frontend.environment]
NEXT_PUBLIC_API_URL = "https://backend.railway.internal"